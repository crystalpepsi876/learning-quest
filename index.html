<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Learning Quest">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#0F0A2E">
  <meta name="description" content="Math, Spelling, Scramble & Geography for grades 2-5">
  <title>Learning Quest</title>
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="icon-192.png">
  <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@500;600;700;800;900&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-deep:#0F0A2E;--bg-mid:#1A1145;--accent-teal:#4ECDC4;--accent-green:#06D6A0;
      --accent-yellow:#FFE66D;--accent-orange:#F97316;--accent-red:#FF6B6B;
      --accent-purple:#A78BFA;--accent-violet:#7C3AED;
      --text-primary:#fff;--text-muted:rgba(255,255,255,0.6);--text-dim:rgba(255,255,255,0.35);
      --glass:rgba(255,255,255,0.06);--glass-border:rgba(255,255,255,0.1);
    }
    *{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
    html,body{min-height:100vh;min-height:100dvh;overflow-x:hidden}
    body{font-family:'Nunito','Segoe UI',sans-serif;background:linear-gradient(145deg,var(--bg-deep) 0%,var(--bg-mid) 35%,#0D1B3E 70%,#071428 100%);color:var(--text-primary);display:flex;justify-content:center;padding:16px;padding-top:env(safe-area-inset-top,16px);padding-bottom:env(safe-area-inset-bottom,16px)}
    #app{width:100%;max-width:560px}
    .btn{border:none;border-radius:16px;cursor:pointer;font-family:inherit;font-weight:700;transition:transform 0.2s,box-shadow 0.2s;-webkit-user-select:none;user-select:none}
    .btn:active{transform:scale(0.96)!important}
    .btn-back{background:rgba(255,255,255,0.08);border:1px solid rgba(255,255,255,0.15);color:rgba(255,255,255,0.8);padding:10px 20px;border-radius:12px;font-size:14px;margin-bottom:16px}
    .screen{display:none;animation:fadeIn 0.35s ease}.screen.active{display:block}
    .title-block{text-align:center;margin:24px 0 32px}
    .main-title{font-size:clamp(34px,9vw,50px);font-weight:900;background:linear-gradient(135deg,var(--accent-yellow),var(--accent-orange),var(--accent-red),var(--accent-purple));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;letter-spacing:-1px;line-height:1.1}
    .subtitle{font-size:16px;color:var(--text-muted);margin-top:8px;font-weight:600}
    .name-input-wrap{display:flex;flex-direction:column;align-items:center;gap:16px;margin-top:10px}
    .name-input{width:100%;max-width:360px;padding:16px 20px;border-radius:16px;border:2px solid rgba(255,255,255,0.2);background:rgba(255,255,255,0.08);color:#fff;font-size:22px;font-weight:700;font-family:inherit;outline:none;text-align:center;transition:border-color 0.2s}
    .name-input:focus{border-color:var(--accent-teal)}
    .name-input::placeholder{color:rgba(255,255,255,0.25)}
    .btn-go{padding:16px 48px;font-size:20px;color:#fff;border-radius:18px;background:linear-gradient(135deg,var(--accent-green),#00B894);box-shadow:0 4px 20px rgba(6,214,160,0.4)}
    .subject-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    .subject-card{display:flex;flex-direction:column;align-items:center;gap:4px;padding:22px 14px;border-radius:20px;color:#fff;width:100%;box-shadow:0 6px 24px rgba(0,0,0,0.3)}
    .subject-card.math{background:linear-gradient(135deg,#1e3a5f,#2d5a87);border:1px solid rgba(78,205,196,0.3)}
    .subject-card.spelling{background:linear-gradient(135deg,#3b1f5e,#5b2d8e);border:1px solid rgba(167,139,250,0.3)}
    .subject-card.scramble{background:linear-gradient(135deg,#8B4513,#D2691E);border:1px solid rgba(255,165,0,0.3)}
    .subject-card.geography{background:linear-gradient(135deg,#0d6e3f,#15a05a);border:1px solid rgba(6,214,160,0.3)}
    .subject-icon{font-size:36px}
    .subject-label{font-size:18px;font-weight:800}
    .subject-desc{font-size:11px;color:rgba(255,255,255,0.6);font-weight:500;text-align:center}
    .grade-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    .grade-card{display:flex;flex-direction:column;align-items:center;gap:4px;padding:30px 16px;border-radius:20px;color:#fff;width:100%;box-shadow:0 6px 24px rgba(0,0,0,0.3)}
    .grade-card.g2{background:linear-gradient(135deg,#FF6B6B,#EE5A24)}.grade-card.g3{background:linear-gradient(135deg,#4ECDC4,#0ABDE3)}.grade-card.g4{background:linear-gradient(135deg,#A78BFA,#7C3AED)}.grade-card.g5{background:linear-gradient(135deg,#F97316,#F59E0B)}
    .grade-number{font-size:22px;font-weight:800}.grade-age{font-size:12px;color:rgba(255,255,255,0.7);font-weight:500}
    .voice-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    .voice-card{display:flex;flex-direction:column;align-items:center;gap:6px;padding:24px 12px;border-radius:20px;color:#fff;width:100%;box-shadow:0 6px 24px rgba(0,0,0,0.3);transition:outline 0.2s;outline:3px solid transparent;outline-offset:3px}
    .voice-card.selected{outline:3px solid var(--accent-yellow)}
    .voice-card.us-woman{background:linear-gradient(135deg,#E91E8C,#C2185B)}.voice-card.us-man{background:linear-gradient(135deg,#1565C0,#0D47A1)}.voice-card.uk-woman{background:linear-gradient(135deg,#7B1FA2,#4A148C)}.voice-card.uk-man{background:linear-gradient(135deg,#2E7D32,#1B5E20)}
    .voice-emoji{font-size:36px}.voice-label{font-size:14px;font-weight:800;text-align:center}.voice-preview{font-size:10px;color:rgba(255,255,255,0.6);font-weight:600}
    .play-header{display:flex;justify-content:space-between;align-items:flex-start;flex-wrap:wrap;gap:10px;margin-bottom:14px}
    .stats-row{display:flex;gap:8px;flex-wrap:wrap}
    .stat-badge{display:flex;flex-direction:column;align-items:center;background:var(--glass);border:1px solid var(--glass-border);border-radius:12px;padding:5px 12px;min-width:56px}
    .stat-label{font-size:9px;text-transform:uppercase;letter-spacing:1px;color:rgba(255,255,255,0.45);font-weight:700}
    .stat-value{font-size:17px;font-weight:800;color:var(--accent-yellow)}
    .progress-section{margin-bottom:20px}
    .progress-label{font-size:12px;color:rgba(255,255,255,0.5);margin-bottom:5px;font-weight:600;text-align:center}
    .progress-track{position:relative;height:10px;background:rgba(255,255,255,0.08);border-radius:10px;overflow:visible}
    .progress-fill{height:100%;border-radius:10px;transition:width 0.5s ease;background:linear-gradient(90deg,var(--accent-teal),var(--accent-green),var(--accent-yellow))}
    .progress-dot{position:absolute;top:50%;width:13px;height:13px;border-radius:50%;border:2px solid rgba(255,255,255,0.35);transition:all 0.3s ease;transform:translate(-50%,-50%)}
    .progress-dot.filled{background:var(--accent-yellow)!important;transform:translate(-50%,-50%) scale(1.2)}
    .problem-card{background:var(--glass);border:1px solid var(--glass-border);border-radius:24px;padding:28px 20px 22px;text-align:center;backdrop-filter:blur(10px);box-shadow:0 12px 40px rgba(0,0,0,0.3)}
    .problem-type{font-size:12px;color:rgba(255,255,255,0.45);text-transform:uppercase;letter-spacing:1.5px;font-weight:700;margin-bottom:16px}
    .math-expression{font-size:clamp(30px,8vw,42px);font-weight:900;color:#fff;letter-spacing:2px;display:block;margin-bottom:22px}
    .spelling-area{display:flex;flex-direction:column;align-items:center;gap:10px;margin-bottom:18px}
    .btn-speak{background:linear-gradient(135deg,var(--accent-purple),var(--accent-violet));padding:14px 28px;font-size:17px;color:#fff;box-shadow:0 4px 20px rgba(124,58,237,0.4)}
    .btn-sentence{background:linear-gradient(135deg,#E91E8C,#C2185B);padding:10px 22px;font-size:14px;color:#fff;box-shadow:0 3px 14px rgba(233,30,140,0.3)}
    .hint-text{font-size:14px;color:var(--text-muted);font-family:'Courier New',monospace;letter-spacing:3px}
    .scramble-display{font-size:clamp(28px,7vw,38px);font-weight:900;color:var(--accent-yellow);letter-spacing:4px;display:block;margin-bottom:22px;font-family:'Courier New',monospace}
    .geo-question{font-size:clamp(17px,4.5vw,22px);font-weight:800;color:#fff;margin-bottom:20px;line-height:1.4}
    .geo-options{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:14px}
    .geo-opt{padding:14px 12px;border-radius:14px;background:rgba(255,255,255,0.08);border:2px solid rgba(255,255,255,0.15);color:#fff;font-size:15px;font-weight:700;font-family:inherit;cursor:pointer;transition:all 0.2s;text-align:center}
    .geo-opt:active{transform:scale(0.96)}
    .geo-opt.correct-pick{background:linear-gradient(135deg,var(--accent-green),#00B894)!important;border-color:var(--accent-green)!important}
    .geo-opt.wrong-pick{background:linear-gradient(135deg,var(--accent-red),#EE5A24)!important;border-color:var(--accent-red)!important}
    .geo-opt.reveal-correct{border-color:var(--accent-green)!important;box-shadow:0 0 12px rgba(6,214,160,0.5)}
    .input-row{display:flex;gap:10px;margin-bottom:14px}
    .answer-input{flex:1;padding:14px 16px;border-radius:14px;border:2px solid rgba(255,255,255,0.15);background:rgba(255,255,255,0.06);color:#fff;font-size:20px;font-weight:700;font-family:inherit;outline:none;text-align:center;transition:border-color 0.2s;min-width:0}
    .answer-input:focus{border-color:var(--accent-teal)}.answer-input::placeholder{color:rgba(255,255,255,0.25)}
    .btn-submit{padding:14px 24px;background:linear-gradient(135deg,var(--accent-green),#00B894);color:#fff;font-size:17px;font-weight:800;white-space:nowrap;box-shadow:0 4px 16px rgba(6,214,160,0.35)}
    .feedback-banner{border-radius:14px;padding:14px 18px;display:flex;flex-direction:column;gap:4px;animation:slideUp 0.3s ease}
    .feedback-banner.correct{background:linear-gradient(135deg,var(--accent-green),#00B894)}.feedback-banner.wrong{background:linear-gradient(135deg,var(--accent-red),#EE5A24)}
    .feedback-text{font-size:17px;font-weight:700}.correct-answer-text{font-size:13px;color:rgba(255,255,255,0.85)}
    .info-footer{text-align:center;font-size:11px;color:var(--text-dim);margin-top:18px;font-weight:600;letter-spacing:0.5px}
    .level-up-overlay{position:fixed;inset:0;display:flex;justify-content:center;align-items:center;z-index:9998;pointer-events:none}
    .level-up-box{background:linear-gradient(135deg,var(--accent-yellow),var(--accent-orange));color:var(--bg-mid);padding:28px 36px;border-radius:24px;font-size:clamp(18px,5vw,26px);font-weight:900;box-shadow:0 12px 50px rgba(249,115,22,0.5);animation:levelPop 0.5s ease;text-align:center;line-height:1.4}
    .level-up-goat{font-size:clamp(48px,12vw,72px);display:block;margin-bottom:8px}
    .confetti-piece{position:fixed;top:-20px;pointer-events:none;z-index:9999}
    .streak-flame{display:inline-block;animation:flamePulse 0.5s ease infinite alternate}
    @keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
    @keyframes slideUp{from{transform:translateY(10px);opacity:0}to{transform:translateY(0);opacity:1}}
    @keyframes levelPop{0%{transform:scale(0.5);opacity:0}60%{transform:scale(1.15)}100%{transform:scale(1);opacity:1}}
    @keyframes flamePulse{0%{transform:scale(1) translateY(0)}100%{transform:scale(1.15) translateY(-2px)}}
    @keyframes confettiFall{0%{transform:translateY(0) rotate(0deg);opacity:1}100%{transform:translateY(100vh) rotate(720deg);opacity:0}}
    @keyframes goatBounce{0%,100%{transform:scale(1)}50%{transform:scale(1.25) rotate(-8deg)}}
    input[type="number"]::-webkit-inner-spin-button,input[type="number"]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}
    input[type="number"]{-moz-appearance:textfield}
  </style>
</head>
<body>
<div id="app">

  <!-- NAME SCREEN -->
  <div id="screen-name" class="screen active">
    <div class="title-block" style="margin-top:40px">
      <h1 class="main-title">Learning Quest</h1>
      <p class="subtitle">What's your name, superstar?</p>
    </div>
    <div class="name-input-wrap">
      <input id="name-input" class="name-input" placeholder="Type your name..." maxlength="20" autocomplete="off">
      <button class="btn btn-go" onclick="submitName()">Let's Go! üöÄ</button>
    </div>
  </div>

  <!-- HOME SCREEN -->
  <div id="screen-home" class="screen">
    <div class="title-block">
      <h1 class="main-title">Learning Quest</h1>
      <p class="subtitle" id="home-greeting">Pick a subject!</p>
    </div>
    <div class="subject-grid">
      <button class="btn subject-card math" onclick="selectSubject('math')">
        <span class="subject-icon">üî¢</span><span class="subject-label">Math</span>
        <span class="subject-desc">Add, subtract, multiply & more</span>
      </button>
      <button class="btn subject-card spelling" onclick="selectSubject('spelling')">
        <span class="subject-icon">üìñ</span><span class="subject-label">Spelling</span>
        <span class="subject-desc">Listen and spell correctly</span>
      </button>
      <button class="btn subject-card scramble" onclick="selectSubject('scramble')">
        <span class="subject-icon">üîÄ</span><span class="subject-label">Scramble</span>
        <span class="subject-desc">Unscramble the mixed-up word</span>
      </button>
      <button class="btn subject-card geography" onclick="selectSubject('geography')">
        <span class="subject-icon">üåç</span><span class="subject-label">Geography</span>
        <span class="subject-desc">Explore the world</span>
      </button>
    </div>
  </div>

  <!-- VOICE SELECT -->
  <div id="screen-voice" class="screen">
    <button class="btn btn-back" onclick="showScreen('home')">‚Üê Back</button>
    <div class="title-block">
      <h1 class="main-title">üìñ Spelling</h1>
      <p class="subtitle">Choose a voice</p>
    </div>
    <div class="voice-grid">
      <button class="btn voice-card us-woman" onclick="selectVoice('us-woman',this)"><span class="voice-emoji">üá∫üá∏üë©</span><span class="voice-label">American Woman</span><span class="voice-preview">Tap to preview</span></button>
      <button class="btn voice-card us-man" onclick="selectVoice('us-man',this)"><span class="voice-emoji">üá∫üá∏üë®</span><span class="voice-label">American Man</span><span class="voice-preview">Tap to preview</span></button>
      <button class="btn voice-card uk-woman" onclick="selectVoice('uk-woman',this)"><span class="voice-emoji">üá¨üáßüë©</span><span class="voice-label">English Woman</span><span class="voice-preview">Tap to preview</span></button>
      <button class="btn voice-card uk-man" onclick="selectVoice('uk-man',this)"><span class="voice-emoji">üá¨üáßüë®</span><span class="voice-label">English Man</span><span class="voice-preview">Tap to preview</span></button>
    </div>
    <div style="text-align:center;margin-top:20px"><button class="btn btn-go" id="btn-confirm-voice" onclick="confirmVoice()" style="display:none">Use This Voice ‚úì</button></div>
  </div>

  <!-- GRADE SELECT -->
  <div id="screen-grade" class="screen">
    <button class="btn btn-back" onclick="goBackFromGrade()">‚Üê Back</button>
    <div class="title-block">
      <h1 class="main-title" id="grade-title">üî¢ Math</h1>
      <p class="subtitle">Choose your grade level</p>
    </div>
    <div class="grade-grid">
      <button class="btn grade-card g2" onclick="startGame(2)"><span class="grade-number">Grade 2</span><span class="grade-age">Ages 7-8</span></button>
      <button class="btn grade-card g3" onclick="startGame(3)"><span class="grade-number">Grade 3</span><span class="grade-age">Ages 8-9</span></button>
      <button class="btn grade-card g4" onclick="startGame(4)"><span class="grade-number">Grade 4</span><span class="grade-age">Ages 9-10</span></button>
      <button class="btn grade-card g5" onclick="startGame(5)"><span class="grade-number">Grade 5</span><span class="grade-age">Ages 10-11</span></button>
    </div>
  </div>

  <!-- PLAY SCREEN -->
  <div id="screen-play" class="screen">
    <div class="play-header">
      <button class="btn btn-back" onclick="showScreen('home')">‚Üê Home</button>
      <div class="stats-row">
        <div class="stat-badge"><span class="stat-label">Score</span><span class="stat-value" id="stat-score">0/0</span></div>
        <div class="stat-badge"><span class="stat-label">Streak</span><span class="stat-value" id="stat-streak">0</span></div>
        <div class="stat-badge"><span class="stat-label">Level</span><span class="stat-value" id="stat-level">1/5</span></div>
      </div>
    </div>
    <div class="progress-section">
      <div class="progress-label" id="progress-label"></div>
      <div class="progress-track">
        <div class="progress-fill" id="progress-fill" style="width:0%"></div>
        <div class="progress-dot" id="dot-0" style="left:25%"></div>
        <div class="progress-dot" id="dot-1" style="left:50%"></div>
        <div class="progress-dot" id="dot-2" style="left:75%"></div>
        <div class="progress-dot" id="dot-3" style="left:100%"></div>
      </div>
    </div>
    <div class="problem-card">
      <div class="problem-type" id="problem-type"></div>
      <!-- Math -->
      <div id="math-area" style="display:none"><span class="math-expression" id="math-expression"></span></div>
      <!-- Spelling -->
      <div id="spelling-area" class="spelling-area" style="display:none">
        <button class="btn btn-speak" onclick="speakWord()">üîä Hear the Word (√ó2)</button>
        <button class="btn btn-sentence" onclick="speakSentence()">üìù Use in a Sentence</button>
        <div class="hint-text" id="hint-text" style="display:none"></div>
      </div>
      <!-- Scramble -->
      <div id="scramble-area" style="display:none"><span class="scramble-display" id="scramble-display"></span></div>
      <!-- Geography -->
      <div id="geo-area" style="display:none">
        <div class="geo-question" id="geo-question"></div>
        <div class="geo-options" id="geo-options"></div>
      </div>
      <!-- Text input (math, spelling, scramble) -->
      <div id="text-input-area" class="input-row">
        <input id="answer-input" class="answer-input" placeholder="Your answer..." autocomplete="off" autocapitalize="off" spellcheck="false">
        <button class="btn btn-submit" onclick="checkAnswer()">Check ‚úì</button>
      </div>
      <div id="feedback" style="display:none"></div>
    </div>
    <div class="info-footer" id="info-footer"></div>
  </div>

  <div id="level-up-overlay" class="level-up-overlay" style="display:none"><div class="level-up-box" id="level-up-msg"></div></div>
  <div id="confetti-container"></div>
</div>

<script>
    // ===================== WORD BANKS =====================
    const SPELLING_WORDS = {
      2:{1:["cat","dog","run","big","sun","hat","bed","map","cup","leg","pig","top","red","box","fun"],2:["jump","play","stop","fish","tree","frog","milk","duck","wish","king","drum","ship","nest","pink","lamp"],3:["happy","green","sleep","black","brown","plant","three","white","small","bring","drink","smile","float","chair","stone"],4:["friend","should","please","school","people","around","before","twelve","change","follow","pretty","always","animal","father","mother"],5:["because","through","thought","brother","another","morning","nothing","tonight","outside","picture","between","hundred","kitchen","blanket","mittens"]},
      3:{1:["lake","home","time","five","give","come","some","bone","note","fire","more","side","wide","hope","ride"],2:["begin","study","water","never","after","story","every","again","world","write","start","laugh","power","guess","quiet"],3:["beauty","center","simple","circle","listen","castle","garden","orange","planet","silver","street","bridge","finger","basket","ladder"],4:["trouble","country","weather","journey","already","evening","against","certain","million","special","library","mystery","harvest","balance","captain"],5:["calendar","elephant","favorite","surprise","sandwich","dinosaur","sentence","treasure","question","engineer","alphabet","document","umbrella","birthday","complete"]},
      4:{1:["brave","grain","youth","chief","sworn","claim","drift","flame","globe","marsh","nerve","pride","reign","sweep","vault"],2:["breeze","canyon","divide","falcon","gadget","impact","legend","magnet","narrow","orphan","pastel","rescue","salmon","target","vacuum"],3:["achieve","bargain","compete","decimal","exhaust","fiction","grizzly","horizon","inquiry","lantern","mineral","nucleus","opinion","portion","reflect"],4:["abundant","collapse","distance","evidence","fragment","generate","monopoly","navigate","opposite","passport","quantity","recharge","syllable","triangle","universe"],5:["advantage","brilliant","character","determine","education","frequency","guarantee","imaginary","knowledge","machinery","necessary","operation","passenger","recognize","structure"]},
      5:{1:["adept","clash","dwell","forge","guilt","haven","knack","moral","plead","quota","realm","swear","trait","vigor","yield"],2:["absorb","census","diesel","embark","fiesta","gravel","ignite","jostle","kernel","locker","muster","novice","phenom","summit","whimsy"],3:["acquire","crusade","descent","exhibit","genuine","loyalty","optimum","perplex","rapport","stadium","tribute","venture","warrant","analyze","broaden"],4:["altitude","boundary","campaign","domestic","exchange","flourish","hardship","invasion","judgment","latitude","merchant","nuisance","peculiar","radiance","sequence"],5:["abolition","chameleon","deception","elaborate","fascinate","guarantee","hypnotize","improvise","maneuvers","negotiate","privilege","reinforce","stimulate","technique","versatile"]},
    };


    const SENTENCES = {
      "cat": "The cat sat on the warm rug.",
      "dog": "My dog loves to play fetch.",
      "run": "I like to run in the park.",
      "big": "That is a really big tree.",
      "sun": "The sun is bright today.",
      "hat": "She wore a red hat outside.",
      "bed": "I made my bed this morning.",
      "map": "We used a map on our trip.",
      "cup": "Please fill my cup with water.",
      "leg": "The dog hurt its back leg.",
      "pig": "The pig rolled in the mud.",
      "top": "He climbed to the top of the hill.",
      "red": "My favorite color is red.",
      "box": "Put the toys in the box.",
      "fun": "Playing outside is so much fun.",
      "jump": "Watch me jump over the puddle.",
      "play": "Let's play a game together.",
      "stop": "You must stop at the red light.",
      "fish": "We caught a big fish at the lake.",
      "tree": "A bird built a nest in the tree.",
      "frog": "The green frog hopped away.",
      "milk": "I drink milk with my cereal.",
      "duck": "The duck swam across the pond.",
      "wish": "I wish I could fly like a bird.",
      "king": "The king sat on his golden throne.",
      "drum": "He played the drum in the band.",
      "ship": "The ship sailed across the ocean.",
      "nest": "The bird sat in its cozy nest.",
      "pink": "She painted her room pink.",
      "lamp": "Turn on the lamp so we can read.",
      "happy": "I feel happy on sunny days.",
      "green": "The grass is very green today.",
      "sleep": "I need eight hours of sleep.",
      "black": "The black cat crossed the road.",
      "brown": "He has brown eyes like his mom.",
      "plant": "We will plant seeds in the garden.",
      "three": "I have three best friends at school.",
      "white": "Fresh snow is bright white.",
      "small": "The kitten is very small.",
      "bring": "Please bring your backpack to class.",
      "drink": "I need a drink of cold water.",
      "smile": "Her smile made everyone feel better.",
      "float": "The balloon will float up high.",
      "chair": "Please sit in your chair quietly.",
      "stone": "He skipped a stone across the water.",
      "friend": "My best friend lives next door.",
      "should": "You should always be kind to others.",
      "please": "May I please have some more?",
      "school": "I walk to school every morning.",
      "people": "Many people came to the fair.",
      "around": "The dog ran around the yard.",
      "before": "Wash your hands before dinner.",
      "twelve": "There are twelve months in a year.",
      "change": "The leaves change color in fall.",
      "follow": "Please follow me to the library.",
      "pretty": "The garden looks so pretty in spring.",
      "always": "She always does her best work.",
      "animal": "The zoo has every kind of animal.",
      "father": "My father taught me to ride a bike.",
      "mother": "My mother makes the best pancakes.",
      "because": "I smiled because I was happy.",
      "through": "We walked through the tunnel.",
      "thought": "I thought the movie was great.",
      "brother": "My brother is older than me.",
      "another": "May I have another cookie please?",
      "morning": "The birds sing every morning.",
      "nothing": "There is nothing in the empty box.",
      "tonight": "We are having pizza tonight.",
      "outside": "Let's go play outside after lunch.",
      "picture": "She drew a beautiful picture.",
      "between": "The park is between two buildings.",
      "hundred": "There are one hundred pennies in a dollar.",
      "kitchen": "Mom is cooking in the kitchen.",
      "blanket": "The soft blanket kept me warm.",
      "mittens": "Wear your mittens when it snows.",
      "lake": "We swam in the lake all summer.",
      "home": "There is no place like home.",
      "time": "What time does the movie start?",
      "five": "I have five fingers on each hand.",
      "give": "I will give you my extra pencil.",
      "come": "Please come to my birthday party.",
      "some": "Would you like some fruit?",
      "bone": "The dog buried its bone in the yard.",
      "note": "She left a note on the fridge.",
      "fire": "We roasted marshmallows over the fire.",
      "more": "I would like more time to finish.",
      "side": "Walk on the right side of the hall.",
      "wide": "The river was very wide.",
      "hope": "I hope we win the game today.",
      "ride": "Let's ride our bikes to the park.",
      "begin": "Let's begin the lesson now.",
      "study": "I need to study for my test.",
      "water": "Drink plenty of water every day.",
      "never": "I have never seen a shooting star.",
      "after": "We have recess after lunch.",
      "story": "Grandma told us a funny story.",
      "every": "She practices piano every day.",
      "again": "Can you say that again please?",
      "world": "There are many countries in the world.",
      "write": "Please write your name on the paper.",
      "start": "The race will start at noon.",
      "laugh": "That joke made everyone laugh.",
      "power": "The storm knocked out the power.",
      "guess": "Can you guess what I am thinking?",
      "quiet": "The library is a quiet place.",
      "beauty": "The sunset was a thing of beauty.",
      "center": "The fountain is in the center of town.",
      "simple": "The recipe is quick and simple.",
      "circle": "The children sat in a circle.",
      "listen": "Please listen carefully to the directions.",
      "castle": "The old castle sits on a hill.",
      "garden": "We planted tomatoes in the garden.",
      "orange": "I peeled an orange for my snack.",
      "planet": "Earth is the third planet from the sun.",
      "silver": "She wore a silver necklace.",
      "street": "Look both ways before crossing the street.",
      "bridge": "The bridge goes over the river.",
      "finger": "She pointed her finger at the map.",
      "basket": "The basket was full of apples.",
      "ladder": "He climbed up the tall ladder.",
      "trouble": "Lying will only get you in trouble.",
      "country": "What country would you like to visit?",
      "weather": "The weather is perfect for a picnic.",
      "journey": "The journey to grandma's takes two hours.",
      "already": "I have already finished my homework.",
      "evening": "Stars appear in the evening sky.",
      "against": "He leaned against the old fence.",
      "certain": "I am certain the answer is correct.",
      "million": "A million is a very large number.",
      "special": "Today is a very special day.",
      "library": "I returned my books to the library.",
      "mystery": "The missing cat was a real mystery.",
      "harvest": "Farmers harvest crops in the fall.",
      "balance": "She kept her balance on the beam.",
      "captain": "The captain steered the ship safely.",
      "calendar": "Mark the date on your calendar.",
      "elephant": "The elephant is the largest land animal.",
      "favorite": "Pizza is my favorite food.",
      "surprise": "The party was a big surprise.",
      "sandwich": "I packed a sandwich for lunch.",
      "dinosaur": "The dinosaur exhibit was amazing.",
      "sentence": "Please write a complete sentence.",
      "treasure": "The pirates searched for buried treasure.",
      "question": "That is an excellent question.",
      "engineer": "The engineer designed a new bridge.",
      "alphabet": "There are twenty-six letters in the alphabet.",
      "document": "Save the document on your computer.",
      "umbrella": "Bring an umbrella in case it rains.",
      "birthday": "My birthday is in September.",
      "complete": "Did you complete your assignment?",
      "brave": "The brave firefighter saved the family.",
      "grain": "Bread is made from grain.",
      "youth": "She volunteered at the youth center.",
      "chief": "The chief made an important decision.",
      "sworn": "He was sworn in as class president.",
      "claim": "Nobody could claim the lost wallet.",
      "drift": "We watched the clouds drift across the sky.",
      "flame": "The candle flame flickered in the wind.",
      "globe": "She spun the globe to find Japan.",
      "marsh": "Frogs and herons live in the marsh.",
      "nerve": "It took a lot of nerve to speak up.",
      "pride": "She felt great pride in her work.",
      "reign": "The queen had a long and peaceful reign.",
      "sweep": "Please sweep the kitchen floor.",
      "vault": "The gymnast performed an amazing vault.",
      "breeze": "A cool breeze blew through the window.",
      "canyon": "The Grand Canyon is incredibly deep.",
      "divide": "Let's divide the pizza into equal slices.",
      "falcon": "The falcon is one of the fastest birds.",
      "gadget": "That new gadget is really useful.",
      "impact": "The meteor made a huge impact crater.",
      "legend": "She told us the legend of the lost city.",
      "magnet": "The magnet stuck to the refrigerator.",
      "narrow": "The path through the woods was narrow.",
      "orphan": "The kind family adopted the orphan.",
      "pastel": "She drew with pastel colors.",
      "rescue": "The team worked hard to rescue the hikers.",
      "salmon": "The salmon swam upstream to lay eggs.",
      "target": "He hit the target with his first arrow.",
      "vacuum": "Please vacuum the living room carpet.",
      "achieve": "You can achieve anything with hard work.",
      "bargain": "That shirt was a real bargain.",
      "compete": "The two teams will compete on Saturday.",
      "decimal": "Move the decimal point two places.",
      "exhaust": "The long hike will exhaust even the fittest.",
      "fiction": "My favorite genre is science fiction.",
      "grizzly": "The grizzly bear fished in the stream.",
      "horizon": "The sun dipped below the horizon.",
      "inquiry": "The scientist began an inquiry into the cause.",
      "lantern": "The old lantern lit up the dark cave.",
      "mineral": "Quartz is a very common mineral.",
      "nucleus": "The nucleus is the center of a cell.",
      "opinion": "Everyone is entitled to their own opinion.",
      "portion": "She ate a small portion of the pie.",
      "reflect": "The mirror will reflect the light.",
      "abundant": "The garden had an abundant harvest.",
      "collapse": "The old barn started to collapse.",
      "distance": "The distance to the moon is very far.",
      "evidence": "The detective gathered all the evidence.",
      "fragment": "She found a fragment of the old pot.",
      "generate": "Wind turbines generate electricity.",
      "monopoly": "We played a long game of monopoly.",
      "navigate": "Sailors use stars to navigate at sea.",
      "opposite": "Hot is the opposite of cold.",
      "passport": "You need a passport to travel abroad.",
      "quantity": "We ordered a large quantity of supplies.",
      "recharge": "I need to recharge my phone battery.",
      "syllable": "The word banana has three syllables.",
      "triangle": "A triangle has exactly three sides.",
      "universe": "The universe contains billions of stars.",
      "advantage": "Studying gave her an advantage on the test.",
      "brilliant": "She had a brilliant idea for the project.",
      "character": "The main character in the book is brave.",
      "determine": "Scientists work to determine the facts.",
      "education": "A good education opens many doors.",
      "frequency": "The frequency of the sound was very high.",
      "guarantee": "I guarantee you will enjoy this book.",
      "imaginary": "The child played with an imaginary friend.",
      "knowledge": "Reading increases your knowledge.",
      "machinery": "The factory uses heavy machinery.",
      "necessary": "It is necessary to wear a seatbelt.",
      "operation": "The doctor performed a successful operation.",
      "passenger": "Each passenger must have a ticket.",
      "recognize": "I didn't recognize her with short hair.",
      "structure": "The structure of the building is very strong.",
      "adept": "She is quite adept at solving puzzles.",
      "clash": "The two ideas seemed to clash.",
      "dwell": "They dwell in a cottage by the sea.",
      "forge": "The blacksmith used the forge to shape metal.",
      "guilt": "He felt guilt for breaking the vase.",
      "haven": "The library was a quiet haven for readers.",
      "knack": "She has a real knack for drawing.",
      "moral": "The moral of the story is to be honest.",
      "plead": "He had to plead his case before the judge.",
      "quota": "The factory met its production quota.",
      "realm": "The kingdom was the largest realm in the land.",
      "swear": "Do you swear to tell the truth?",
      "trait": "Kindness is a wonderful trait to have.",
      "vigor": "She tackled the project with great vigor.",
      "yield": "The farm will yield a good crop this year.",
      "absorb": "Sponges absorb water very quickly.",
      "census": "The census counts everyone in the country.",
      "diesel": "The truck runs on diesel fuel.",
      "embark": "We will embark on our journey tomorrow.",
      "fiesta": "The town held a colorful fiesta.",
      "gravel": "The driveway was covered with gravel.",
      "ignite": "A single spark can ignite a fire.",
      "jostle": "People jostle for space on the crowded bus.",
      "kernel": "Each kernel of corn popped perfectly.",
      "locker": "I put my books in my locker.",
      "muster": "She tried to muster the courage to speak.",
      "novice": "The novice skier took a beginner lesson.",
      "phenom": "The young player was a true phenom.",
      "summit": "The hikers reached the mountain summit.",
      "whimsy": "The garden was full of whimsy and color.",
      "acquire": "She worked hard to acquire new skills.",
      "crusade": "The school led a crusade against littering.",
      "descent": "The plane began its descent to the airport.",
      "exhibit": "The museum opened a new dinosaur exhibit.",
      "genuine": "His apology seemed genuine and heartfelt.",
      "loyalty": "The dog showed great loyalty to its owner.",
      "optimum": "The optimum temperature for sleep is cool.",
      "perplex": "The riddle continued to perplex everyone.",
      "rapport": "The teacher built a strong rapport with students.",
      "stadium": "The stadium was packed with cheering fans.",
      "tribute": "The concert was a tribute to the musician.",
      "venture": "Starting a business is a bold venture.",
      "warrant": "The evidence did not warrant further action.",
      "analyze": "Scientists analyze data from experiments.",
      "broaden": "Travel can broaden your understanding of the world.",
      "altitude": "The plane flew at a high altitude.",
      "boundary": "The fence marks the boundary of our yard.",
      "campaign": "The candidate ran an exciting campaign.",
      "domestic": "Cats are popular domestic animals.",
      "exchange": "Students in the exchange program visit other countries.",
      "flourish": "Plants flourish with sunlight and water.",
      "hardship": "The pioneers faced great hardship.",
      "invasion": "The invasion of ants ruined our picnic.",
      "judgment": "She showed good judgment in her decision.",
      "latitude": "Lines of latitude run east to west on a map.",
      "merchant": "The merchant sold spices from faraway lands.",
      "nuisance": "The buzzing fly was a real nuisance.",
      "peculiar": "There was a peculiar smell in the kitchen.",
      "radiance": "The radiance of the sunset was breathtaking.",
      "sequence": "Arrange the numbers in the correct sequence.",
      "abolition": "The abolition of slavery was a turning point.",
      "chameleon": "A chameleon can change its color.",
      "deception": "The magician used clever deception.",
      "elaborate": "The artist created an elaborate mural.",
      "fascinate": "Outer space continues to fascinate us.",
      "hypnotize": "The swinging watch seemed to hypnotize him.",
      "improvise": "The musician had to improvise a new melody.",
      "maneuvers": "The pilot performed complex maneuvers.",
      "negotiate": "The two sides tried to negotiate a deal.",
      "privilege": "Voting is both a right and a privilege.",
      "reinforce": "We need to reinforce the bridge supports.",
      "stimulate": "Games can stimulate creative thinking.",
      "technique": "She practiced a new painting technique.",
      "versatile": "A Swiss army knife is a versatile tool.",
    };

    const GEO_QUESTIONS = {
      "2": {
            "1": [
                  {
                        "q": "How many continents are there?",
                        "opts": [
                              "5",
                              "6",
                              "7",
                              "8"
                        ],
                        "a": 2
                  },
                  {
                        "q": "What is the biggest ocean?",
                        "opts": [
                              "Atlantic",
                              "Pacific",
                              "Indian",
                              "Arctic"
                        ],
                        "a": 1
                  },
                  {
                        "q": "What do we call a large body of salt water?",
                        "opts": [
                              "Lake",
                              "River",
                              "Ocean",
                              "Pond"
                        ],
                        "a": 2
                  },
                  {
                        "q": "Which direction does the sun rise?",
                        "opts": [
                              "North",
                              "South",
                              "East",
                              "West"
                        ],
                        "a": 2
                  },
                  {
                        "q": "What shape is the Earth?",
                        "opts": [
                              "Square",
                              "Flat",
                              "Sphere",
                              "Triangle"
                        ],
                        "a": 2
                  },
                  {
                        "q": "What do we call a piece of land surrounded by water?",
                        "opts": [
                              "Mountain",
                              "Island",
                              "Valley",
                              "Desert"
                        ],
                        "a": 1
                  },
                  {
                        "q": "Where do polar bears live?",
                        "opts": [
                              "Desert",
                              "Jungle",
                              "Arctic",
                              "Ocean"
                        ],
                        "a": 2
                  }
            ],
            "2": [
                  {
                        "q": "What country is the Statue of Liberty in?",
                        "opts": [
                              "France",
                              "Canada",
                              "USA",
                              "England"
                        ],
                        "a": 2
                  },
                  {
                        "q": "What is the capital of the United States?",
                        "opts": [
                              "New York",
                              "Washington D.C.",
                              "Los Angeles",
                              "Chicago"
                        ],
                        "a": 1
                  },
                  {
                        "q": "Which continent do we live on? (USA)",
                        "opts": [
                              "Europe",
                              "Asia",
                              "North America",
                              "Africa"
                        ],
                        "a": 2
                  },
                  {
                        "q": "What are the two countries that border the USA?",
                        "opts": [
                              "Mexico & Brazil",
                              "Canada & Mexico",
                              "Canada & Cuba",
                              "England & Mexico"
                        ],
                        "a": 1
                  },
                  {
                        "q": "Which ocean is on the east coast of the USA?",
                        "opts": [
                              "Pacific",
                              "Indian",
                              "Arctic",
                              "Atlantic"
                        ],
                        "a": 3
                  },
                  {
                        "q": "Which ocean is on the west coast of the USA?",
                        "opts": [
                              "Atlantic",
                              "Pacific",
                              "Indian",
                              "Arctic"
                        ],
                        "a": 1
                  },
                  {
                        "q": "What state is known for Hollywood?",
                        "opts": [
                              "Texas",
                              "Florida",
                              "California",
                              "New York"
                        ],
                        "a": 2
                  }
            ],
            "3": [
                  {
                        "q": "Which continent is the largest?",
                        "opts": [
                              "Africa",
                              "Asia",
                              "Europe",
                              "North America"
                        ],
                        "a": 1
                  },
                  {
                        "q": "Which continent is the coldest?",
                        "opts": [
                              "Europe",
                              "Australia",
                              "Antarctica",
                              "Asia"
                        ],
                        "a": 2
                  },
                  {
                        "q": "What is the name of the imaginary line around the middle of Earth?",
                        "opts": [
                              "North Pole",
                              "Equator",
                              "Border",
                              "Horizon"
                        ],
                        "a": 1
                  },
                  {
                        "q": "Penguins live on which continent?",
                        "opts": [
                              "North America",
                              "Africa",
                              "Antarctica",
                              "Europe"
                        ],
                        "a": 2
                  },
                  {
                        "q": "What is the smallest continent?",
                        "opts": [
                              "Europe",
                              "Antarctica",
                              "Australia",
                              "South America"
                        ],
                        "a": 2
                  },
                  {
                        "q": "Which continent has the most countries?",
                        "opts": [
                              "Asia",
                              "Africa",
                              "Europe",
                              "South America"
                        ],
                        "a": 1
                  }
            ],
            "4": [
                  {
                        "q": "What famous landmark is in Paris, France?",
                        "opts": [
                              "Big Ben",
                              "Eiffel Tower",
                              "Colosseum",
                              "Pyramids"
                        ],
                        "a": 1
                  },
                  {
                        "q": "The Great Wall is in which country?",
                        "opts": [
                              "Japan",
                              "India",
                              "China",
                              "Korea"
                        ],
                        "a": 2
                  },
                  {
                        "q": "What is the longest river in the USA?",
                        "opts": [
                              "Mississippi",
                              "Ohio",
                              "Colorado",
                              "Hudson"
                        ],
                        "a": 0
                  },
                  {
                        "q": "Mount Everest is on which continent?",
                        "opts": [
                              "South America",
                              "Europe",
                              "Africa",
                              "Asia"
                        ],
                        "a": 3
                  },
                  {
                        "q": "Which state is the largest in the USA?",
                        "opts": [
                              "Texas",
                              "California",
                              "Alaska",
                              "Montana"
                        ],
                        "a": 2
                  },
                  {
                        "q": "The Sahara Desert is on which continent?",
                        "opts": [
                              "Asia",
                              "Africa",
                              "Australia",
                              "South America"
                        ],
                        "a": 1
                  }
            ],
            "5": [
                  {
                        "q": "North, South, East, and West are called what?",
                        "opts": [
                              "Seasons",
                              "Compass directions",
                              "Continents",
                              "Hemispheres"
                        ],
                        "a": 1
                  },
                  {
                        "q": "The Northern and Southern halves of Earth are called what?",
                        "opts": [
                              "Continents",
                              "Poles",
                              "Hemispheres",
                              "Equators"
                        ],
                        "a": 2
                  },
                  {
                        "q": "Hawaii is surrounded by which ocean?",
                        "opts": [
                              "Atlantic",
                              "Arctic",
                              "Indian",
                              "Pacific"
                        ],
                        "a": 3
                  },
                  {
                        "q": "What natural feature forms the border between many US states?",
                        "opts": [
                              "Mountains",
                              "Deserts",
                              "Rivers",
                              "Forests"
                        ],
                        "a": 2
                  },
                  {
                        "q": "What tool shows direction using a magnetic needle?",
                        "opts": [
                              "Telescope",
                              "Compass",
                              "Thermometer",
                              "Clock"
                        ],
                        "a": 1
                  },
                  {
                        "q": "A map's legend tells you what?",
                        "opts": [
                              "The weather",
                              "What the symbols mean",
                              "The time",
                              "The temperature"
                        ],
                        "a": 1
                  }
            ]
      },
      "3": {
            "1": [
                  {
                        "q": "What is the capital of France?",
                        "opts": [
                              "London",
                              "Paris",
                              "Rome",
                              "Berlin"
                        ],
                        "a": 1
                  },
                  {
                        "q": "Which country looks like a boot?",
                        "opts": [
                              "Spain",
                              "Greece",
                              "Italy",
                              "France"
                        ],
                        "a": 2
                  },
                  {
                        "q": "On which continent is Brazil?",
                        "opts": [
                              "Africa",
                              "Europe",
                              "North America",
                              "South America"
                        ],
                        "a": 3
                  },
                  {
                        "q": "What is the capital of England?",
                        "opts": [
                              "Dublin",
                              "London",
                              "Paris",
                              "Edinburgh"
                        ],
                        "a": 1
                  },
                  {
                        "q": "Which country is famous for kangaroos?",
                        "opts": [
                              "India",
                              "Australia",
                              "Canada",
                              "South Africa"
                        ],
                        "a": 1
                  },
                  {
                        "q": "What country has the most people in the world?",
                        "opts": [
                              "USA",
                              "Russia",
                              "India",
                              "China"
                        ],
                        "a": 2
                  }
            ],
            "2": [
                  {
                        "q": "Which US state is farthest north?",
                        "opts": [
                              "Washington",
                              "Maine",
                              "Minnesota",
                              "Alaska"
                        ],
                        "a": 3
                  },
                  {
                        "q": "The Great Lakes border the USA and which country?",
                        "opts": [
                              "Mexico",
                              "Canada",
                              "Cuba",
                              "Greenland"
                        ],
                        "a": 1
                  },
                  {
                        "q": "Which US state is known as the Sunshine State?",
                        "opts": [
                              "California",
                              "Texas",
                              "Florida",
                              "Hawaii"
                        ],
                        "a": 2
                  },
                  {
                        "q": "What mountain range runs along the east coast of the USA?",
                        "opts": [
                              "Rocky Mountains",
                              "Sierra Nevada",
                              "Appalachian",
                              "Cascade Range"
                        ],
                        "a": 2
                  },
                  {
                        "q": "Which river forms part of the border between the USA and Mexico?",
                        "opts": [
                              "Mississippi",
                              "Rio Grande",
                              "Colorado",
                              "Missouri"
                        ],
                        "a": 1
                  },
                  {
                        "q": "What is the capital of Texas?",
                        "opts": [
                              "Houston",
                              "Dallas",
                              "Austin",
                              "San Antonio"
                        ],
                        "a": 2
                  }
            ],
            "3": [
                  {
                        "q": "The Amazon Rainforest is mostly in which country?",
                        "opts": [
                              "Mexico",
                              "Colombia",
                              "Peru",
                              "Brazil"
                        ],
                        "a": 3
                  },
                  {
                        "q": "What is the largest country by area?",
                        "opts": [
                              "China",
                              "USA",
                              "Canada",
                              "Russia"
                        ],
                        "a": 3
                  },
                  {
                        "q": "Which ocean is between Africa and Australia?",
                        "opts": [
                              "Pacific",
                              "Atlantic",
                              "Indian",
                              "Arctic"
                        ],
                        "a": 2
                  },
                  {
                        "q": "What is the driest continent on Earth?",
                        "opts": [
                              "Africa",
                              "Australia",
                              "Antarctica",
                              "Asia"
                        ],
                        "a": 2
                  },
                  {
                        "q": "The Nile River flows through which continent?",
                        "opts": [
                              "Asia",
                              "South America",
                              "Europe",
                              "Africa"
                        ],
                        "a": 3
                  },
                  {
                        "q": "Which continent has no permanent population?",
                        "opts": [
                              "Australia",
                              "Antarctica",
                              "South America",
                              "Europe"
                        ],
                        "a": 1
                  }
            ],
            "4": [
                  {
                        "q": "What is the tallest mountain in North America?",
                        "opts": [
                              "Mt. Rainier",
                              "Mt. Whitney",
                              "Denali",
                              "Mt. Elbert"
                        ],
                        "a": 2
                  },
                  {
                        "q": "The Pyramids of Giza are in which country?",
                        "opts": [
                              "Iraq",
                              "Egypt",
                              "Morocco",
                              "Turkey"
                        ],
                        "a": 1
                  },
                  {
                        "q": "What country is known for the Taj Mahal?",
                        "opts": [
                              "China",
                              "Japan",
                              "India",
                              "Pakistan"
                        ],
                        "a": 2
                  },
                  {
                        "q": "Which US landmark has four presidents' faces carved in it?",
                        "opts": [
                              "Statue of Liberty",
                              "Mount Rushmore",
                              "Grand Canyon",
                              "Lincoln Memorial"
                        ],
                        "a": 1
                  },
                  {
                        "q": "The Great Barrier Reef is near which country?",
                        "opts": [
                              "Brazil",
                              "Thailand",
                              "Australia",
                              "South Africa"
                        ],
                        "a": 2
                  },
                  {
                        "q": "What famous canal connects the Atlantic and Pacific Oceans?",
                        "opts": [
                              "Suez Canal",
                              "Panama Canal",
                              "Erie Canal",
                              "Grand Canal"
                        ],
                        "a": 1
                  }
            ],
            "5": [
                  {
                        "q": "Lines of longitude run in which direction?",
                        "opts": [
                              "East to West",
                              "North to South",
                              "Diagonal",
                              "In circles"
                        ],
                        "a": 1
                  },
                  {
                        "q": "What is a delta?",
                        "opts": [
                              "A mountain peak",
                              "Land formed at a river's mouth",
                              "A deep valley",
                              "A type of island"
                        ],
                        "a": 1
                  },
                  {
                        "q": "Which country has the longest coastline?",
                        "opts": [
                              "Australia",
                              "Russia",
                              "USA",
                              "Canada"
                        ],
                        "a": 3
                  },
                  {
                        "q": "A peninsula is land surrounded by water on how many sides?",
                        "opts": [
                              "One",
                              "Two",
                              "Three",
                              "Four"
                        ],
                        "a": 2
                  },
                  {
                        "q": "What causes the seasons?",
                        "opts": [
                              "Distance from sun",
                              "Earth's tilt",
                              "The moon",
                              "Ocean currents"
                        ],
                        "a": 1
                  },
                  {
                        "q": "The Prime Meridian passes through which city?",
                        "opts": [
                              "Paris",
                              "New York",
                              "London",
                              "Rome"
                        ],
                        "a": 2
                  }
            ]
      },
      "4": {
            "1": [
                  {
                        "q": "What is the capital of Japan?",
                        "opts": [
                              "Beijing",
                              "Seoul",
                              "Tokyo",
                              "Osaka"
                        ],
                        "a": 2
                  },
                  {
                        "q": "Which country is both a continent and a country?",
                        "opts": [
                              "Greenland",
                              "Australia",
                              "India",
                              "Brazil"
                        ],
                        "a": 1
                  },
                  {
                        "q": "What is the capital of Canada?",
                        "opts": [
                              "Toronto",
                              "Vancouver",
                              "Montreal",
                              "Ottawa"
                        ],
                        "a": 3
                  },
                  {
                        "q": "Which European country is shaped like a boot?",
                        "opts": [
                              "Spain",
                              "Italy",
                              "Greece",
                              "Portugal"
                        ],
                        "a": 1
                  },
                  {
                        "q": "In which country would you find the city of Cairo?",
                        "opts": [
                              "Morocco",
                              "Egypt",
                              "Libya",
                              "Sudan"
                        ],
                        "a": 1
                  },
                  {
                        "q": "What is the capital of Germany?",
                        "opts": [
                              "Munich",
                              "Hamburg",
                              "Berlin",
                              "Frankfurt"
                        ],
                        "a": 2
                  },
                  {
                        "q": "Which South American country is the largest?",
                        "opts": [
                              "Argentina",
                              "Colombia",
                              "Peru",
                              "Brazil"
                        ],
                        "a": 3
                  }
            ],
            "2": [
                  {
                        "q": "What is the capital of Australia?",
                        "opts": [
                              "Sydney",
                              "Melbourne",
                              "Canberra",
                              "Perth"
                        ],
                        "a": 2
                  },
                  {
                        "q": "What is the capital of China?",
                        "opts": [
                              "Shanghai",
                              "Beijing",
                              "Hong Kong",
                              "Guangzhou"
                        ],
                        "a": 1
                  },
                  {
                        "q": "What is the capital of Mexico?",
                        "opts": [
                              "Cancun",
                              "Guadalajara",
                              "Mexico City",
                              "Monterrey"
                        ],
                        "a": 2
                  },
                  {
                        "q": "What is the capital of Brazil?",
                        "opts": [
                              "Rio de Janeiro",
                              "S\u00e3o Paulo",
                              "Bras\u00edlia",
                              "Salvador"
                        ],
                        "a": 2
                  },
                  {
                        "q": "What is the capital of India?",
                        "opts": [
                              "Mumbai",
                              "New Delhi",
                              "Kolkata",
                              "Bangalore"
                        ],
                        "a": 1
                  },
                  {
                        "q": "What is the capital of Russia?",
                        "opts": [
                              "Moscow",
                              "St. Petersburg",
                              "Kiev",
                              "Minsk"
                        ],
                        "a": 0
                  },
                  {
                        "q": "What is the capital of Spain?",
                        "opts": [
                              "Barcelona",
                              "Madrid",
                              "Seville",
                              "Valencia"
                        ],
                        "a": 1
                  }
            ],
            "3": [
                  {
                        "q": "What is the longest river in the world?",
                        "opts": [
                              "Amazon",
                              "Mississippi",
                              "Nile",
                              "Yangtze"
                        ],
                        "a": 2
                  },
                  {
                        "q": "What is the largest desert in the world?",
                        "opts": [
                              "Sahara",
                              "Gobi",
                              "Antarctic",
                              "Arabian"
                        ],
                        "a": 2
                  },
                  {
                        "q": "What is the deepest ocean trench?",
                        "opts": [
                              "Puerto Rico Trench",
                              "Mariana Trench",
                              "Java Trench",
                              "Tonga Trench"
                        ],
                        "a": 1
                  },
                  {
                        "q": "The Rocky Mountains are on which continent?",
                        "opts": [
                              "Europe",
                              "Asia",
                              "South America",
                              "North America"
                        ],
                        "a": 3
                  },
                  {
                        "q": "Which river flows through London?",
                        "opts": [
                              "Seine",
                              "Rhine",
                              "Thames",
                              "Danube"
                        ],
                        "a": 2
                  },
                  {
                        "q": "What mountain range separates Europe from Asia?",
                        "opts": [
                              "Alps",
                              "Andes",
                              "Himalayas",
                              "Urals"
                        ],
                        "a": 3
                  },
                  {
                        "q": "The Dead Sea borders Israel and which country?",
                        "opts": [
                              "Egypt",
                              "Jordan",
                              "Syria",
                              "Lebanon"
                        ],
                        "a": 1
                  }
            ],
            "4": [
                  {
                        "q": "What climate zone is near the equator?",
                        "opts": [
                              "Arctic",
                              "Tropical",
                              "Temperate",
                              "Polar"
                        ],
                        "a": 1
                  },
                  {
                        "q": "What biome has the most biodiversity?",
                        "opts": [
                              "Desert",
                              "Tundra",
                              "Rainforest",
                              "Grassland"
                        ],
                        "a": 2
                  },
                  {
                        "q": "Tundra is found near which part of Earth?",
                        "opts": [
                              "Equator",
                              "Tropics",
                              "Poles",
                              "Temperate zone"
                        ],
                        "a": 2
                  },
                  {
                        "q": "What type of forest loses its leaves in fall?",
                        "opts": [
                              "Tropical",
                              "Coniferous",
                              "Deciduous",
                              "Rainforest"
                        ],
                        "a": 2
                  },
                  {
                        "q": "Which continent has the largest tropical rainforest?",
                        "opts": [
                              "Africa",
                              "Asia",
                              "South America",
                              "North America"
                        ],
                        "a": 2
                  },
                  {
                        "q": "The Sahara Desert has what type of climate?",
                        "opts": [
                              "Tropical",
                              "Arid",
                              "Temperate",
                              "Polar"
                        ],
                        "a": 1
                  }
            ],
            "5": [
                  {
                        "q": "What strait separates Asia from North America?",
                        "opts": [
                              "Gibraltar",
                              "Bering",
                              "Magellan",
                              "Hormuz"
                        ],
                        "a": 1
                  },
                  {
                        "q": "Which sea is the saltiest in the world?",
                        "opts": [
                              "Red Sea",
                              "Dead Sea",
                              "Black Sea",
                              "Caspian Sea"
                        ],
                        "a": 1
                  },
                  {
                        "q": "What is the Ring of Fire?",
                        "opts": [
                              "A desert",
                              "A zone of volcanoes",
                              "A tropical storm",
                              "An ocean current"
                        ],
                        "a": 1
                  },
                  {
                        "q": "What percentage of Earth's surface is covered by water?",
                        "opts": [
                              "50%",
                              "60%",
                              "70%",
                              "80%"
                        ],
                        "a": 2
                  },
                  {
                        "q": "Which country has the most time zones?",
                        "opts": [
                              "Russia",
                              "USA",
                              "China",
                              "France"
                        ],
                        "a": 3
                  },
                  {
                        "q": "What is an archipelago?",
                        "opts": [
                              "A mountain range",
                              "A chain of islands",
                              "A large lake",
                              "A deep valley"
                        ],
                        "a": 1
                  }
            ]
      },
      "5": {
            "1": [
                  {
                        "q": "What is the capital of South Korea?",
                        "opts": [
                              "Busan",
                              "Seoul",
                              "Pyongyang",
                              "Tokyo"
                        ],
                        "a": 1
                  },
                  {
                        "q": "Which African country was never colonized by Europeans?",
                        "opts": [
                              "Nigeria",
                              "Kenya",
                              "Ethiopia",
                              "Ghana"
                        ],
                        "a": 2
                  },
                  {
                        "q": "What is the smallest country in the world?",
                        "opts": [
                              "Monaco",
                              "Malta",
                              "Vatican City",
                              "San Marino"
                        ],
                        "a": 2
                  },
                  {
                        "q": "What country has the most natural lakes?",
                        "opts": [
                              "Russia",
                              "USA",
                              "Canada",
                              "Finland"
                        ],
                        "a": 2
                  },
                  {
                        "q": "Which country is known as the Land of the Rising Sun?",
                        "opts": [
                              "China",
                              "Thailand",
                              "Japan",
                              "Vietnam"
                        ],
                        "a": 2
                  },
                  {
                        "q": "On which continent is the country of Turkey?",
                        "opts": [
                              "Asia only",
                              "Europe only",
                              "Both Asia and Europe",
                              "Africa"
                        ],
                        "a": 2
                  }
            ],
            "2": [
                  {
                        "q": "What is the capital of Egypt?",
                        "opts": [
                              "Alexandria",
                              "Cairo",
                              "Luxor",
                              "Giza"
                        ],
                        "a": 1
                  },
                  {
                        "q": "What is the capital of Argentina?",
                        "opts": [
                              "Santiago",
                              "Lima",
                              "Buenos Aires",
                              "Bogot\u00e1"
                        ],
                        "a": 2
                  },
                  {
                        "q": "What is the capital of Thailand?",
                        "opts": [
                              "Bangkok",
                              "Hanoi",
                              "Manila",
                              "Jakarta"
                        ],
                        "a": 0
                  },
                  {
                        "q": "What is the capital of Kenya?",
                        "opts": [
                              "Lagos",
                              "Nairobi",
                              "Addis Ababa",
                              "Kampala"
                        ],
                        "a": 1
                  },
                  {
                        "q": "What is the capital of Turkey?",
                        "opts": [
                              "Istanbul",
                              "Ankara",
                              "Izmir",
                              "Antalya"
                        ],
                        "a": 1
                  },
                  {
                        "q": "What is the capital of New Zealand?",
                        "opts": [
                              "Auckland",
                              "Christchurch",
                              "Wellington",
                              "Queenstown"
                        ],
                        "a": 2
                  }
            ],
            "3": [
                  {
                        "q": "The Andes are the longest mountain range. Where are they?",
                        "opts": [
                              "Asia",
                              "North America",
                              "Europe",
                              "South America"
                        ],
                        "a": 3
                  },
                  {
                        "q": "What is the largest lake in Africa?",
                        "opts": [
                              "Lake Chad",
                              "Lake Victoria",
                              "Lake Tanganyika",
                              "Lake Malawi"
                        ],
                        "a": 1
                  },
                  {
                        "q": "Through how many countries does the Amazon River flow?",
                        "opts": [
                              "3",
                              "5",
                              "7",
                              "9"
                        ],
                        "a": 3
                  },
                  {
                        "q": "What is the highest waterfall in the world?",
                        "opts": [
                              "Niagara Falls",
                              "Angel Falls",
                              "Victoria Falls",
                              "Iguazu Falls"
                        ],
                        "a": 1
                  },
                  {
                        "q": "The Gobi Desert is in which two countries?",
                        "opts": [
                              "Iran & Iraq",
                              "China & Mongolia",
                              "India & Pakistan",
                              "Egypt & Libya"
                        ],
                        "a": 1
                  },
                  {
                        "q": "What is the largest island in the world?",
                        "opts": [
                              "Madagascar",
                              "Borneo",
                              "Greenland",
                              "New Guinea"
                        ],
                        "a": 2
                  }
            ],
            "4": [
                  {
                        "q": "What language is most widely spoken as a first language?",
                        "opts": [
                              "English",
                              "Spanish",
                              "Mandarin Chinese",
                              "Hindi"
                        ],
                        "a": 2
                  },
                  {
                        "q": "Which country produces the most coffee?",
                        "opts": [
                              "Colombia",
                              "Ethiopia",
                              "Brazil",
                              "Vietnam"
                        ],
                        "a": 2
                  },
                  {
                        "q": "What is the most visited country in the world?",
                        "opts": [
                              "USA",
                              "Spain",
                              "France",
                              "Italy"
                        ],
                        "a": 2
                  },
                  {
                        "q": "The Silk Road connected China to where?",
                        "opts": [
                              "Africa",
                              "Americas",
                              "Europe",
                              "Australia"
                        ],
                        "a": 2
                  },
                  {
                        "q": "What currency is used in Japan?",
                        "opts": [
                              "Won",
                              "Yuan",
                              "Yen",
                              "Baht"
                        ],
                        "a": 2
                  },
                  {
                        "q": "Which country is famous for its fjords?",
                        "opts": [
                              "Sweden",
                              "Norway",
                              "Finland",
                              "Iceland"
                        ],
                        "a": 1
                  }
            ],
            "5": [
                  {
                        "q": "What is the International Date Line?",
                        "opts": [
                              "The equator",
                              "The Prime Meridian",
                              "A line at 180\u00b0 longitude",
                              "The Tropic of Cancer"
                        ],
                        "a": 2
                  },
                  {
                        "q": "What causes ocean tides?",
                        "opts": [
                              "Wind",
                              "Earth's rotation",
                              "Gravity of the Moon",
                              "Earthquakes"
                        ],
                        "a": 2
                  },
                  {
                        "q": "What is the difference between weather and climate?",
                        "opts": [
                              "They are the same",
                              "Climate is daily, weather is long-term",
                              "Weather is daily, climate is long-term",
                              "Climate is about wind only"
                        ],
                        "a": 2
                  },
                  {
                        "q": "What are tectonic plates?",
                        "opts": [
                              "Ocean floors",
                              "Large pieces of Earth's crust",
                              "Cloud formations",
                              "Mountain ranges"
                        ],
                        "a": 1
                  },
                  {
                        "q": "The Gulf Stream is a type of what?",
                        "opts": [
                              "Wind pattern",
                              "Ocean current",
                              "River system",
                              "Tectonic plate"
                        ],
                        "a": 1
                  },
                  {
                        "q": "What is erosion?",
                        "opts": [
                              "Volcanic eruption",
                              "Wearing away of land by wind or water",
                              "Growth of mountains",
                              "Flooding"
                        ],
                        "a": 1
                  }
            ]
      }
};

    // ===================== STATE =====================
    var state = {
      playerName:'', subject:null, grade:null, difficulty:1,
      voiceChoice:'us-woman', problem:null, streak:0,
      totalCorrect:0, totalAttempted:0,
      consecutiveCorrect:0, consecutiveWrong:0,
      usedWords:{}, usedGeo:{}, geoLocked:false,
    };
    var CORRECT_TO_LEVEL_UP = 4, WRONG_TO_LEVEL_DOWN = 3;

    function randInt(a,b){return Math.floor(Math.random()*(b-a+1))+a}
    function pickRandom(arr){return arr[Math.floor(Math.random()*arr.length)]}
    var CORRECT_MSGS=["Awesome! üéâ","You got it! ‚≠ê","Amazing! üöÄ","Brilliant! üí°","Super star! üåü","Nailed it! üéØ","Fantastic! üéä","Way to go! üèÜ","Perfect! üíé","Outstanding! üî•","You rock! üé∏","Incredible! ü¶Ñ"];
    var WRONG_MSGS=["Almost! Try again! üí™","So close! Keep going! üåà","Not quite, you'll get the next one! üçÄ","Keep trying! You're learning! üìö"];

    // ===================== GOAT SOUND =====================
    var audioCtx=null;
    function getAudioCtx(){if(!audioCtx)audioCtx=new(window.AudioContext||window.webkitAudioContext)();return audioCtx}
    function playGoatSound(){
      try{var ctx=getAudioCtx();if(ctx.state==='suspended')ctx.resume();
      for(var i=0;i<3;i++){var t=ctx.currentTime+i*0.22;var osc=ctx.createOscillator();var gain=ctx.createGain();var vib=ctx.createOscillator();var vibG=ctx.createGain();
      vib.frequency.value=25+i*5;vibG.gain.value=80;vib.connect(vibG);vibG.connect(osc.frequency);
      osc.type='sawtooth';osc.frequency.setValueAtTime(600+i*40,t);osc.frequency.linearRampToValueAtTime(350+i*30,t+0.15);
      gain.gain.setValueAtTime(0,t);gain.gain.linearRampToValueAtTime(0.25,t+0.03);gain.gain.linearRampToValueAtTime(0.18,t+0.1);gain.gain.linearRampToValueAtTime(0,t+0.2);
      osc.connect(gain);gain.connect(ctx.destination);vib.start(t);osc.start(t);vib.stop(t+0.25);osc.stop(t+0.25)}}catch(e){}
    }

    // ===================== MATH GENERATOR =====================
    function generateMathProblem(grade,diff){
      var a,b,answer,question;
      if(grade===2){if(diff<=2){a=randInt(1,10*diff);b=randInt(1,10*diff);if(Math.random()>0.5){answer=a+b;question=a+' + '+b}else{if(a<b){var tmp=a;a=b;b=tmp}answer=a-b;question=a+' ‚àí '+b}}else if(diff===3){a=randInt(10,50);b=randInt(10,50);if(Math.random()>0.5){answer=a+b;question=a+' + '+b}else{if(a<b){var tmp=a;a=b;b=tmp}answer=a-b;question=a+' ‚àí '+b}}else if(diff===4){a=randInt(2,5);b=randInt(2,5);answer=a*b;question=a+' √ó '+b}else{a=randInt(2,10);b=randInt(2,10);answer=a*b;question=a+' √ó '+b}}
      else if(grade===3){if(diff<=2){a=randInt(10,50*diff);b=randInt(10,50*diff);if(Math.random()>0.5){answer=a+b;question=a+' + '+b}else{if(a<b){var tmp=a;a=b;b=tmp}answer=a-b;question=a+' ‚àí '+b}}else if(diff===3){a=randInt(2,9);b=randInt(2,9);answer=a*b;question=a+' √ó '+b}else if(diff===4){a=randInt(2,9);b=randInt(2,9);var p=a*b;answer=b;question=p+' √∑ '+a}else{a=randInt(100,500);b=randInt(100,500);answer=a+b;question=a+' + '+b}}
      else if(grade===4){if(diff<=2){a=randInt(2,12);b=randInt(2,12);answer=a*b;question=a+' √ó '+b}else if(diff===3){a=randInt(12,50);b=randInt(2,9);answer=a*b;question=a+' √ó '+b}else if(diff===4){b=randInt(2,12);answer=randInt(5,25);a=b*answer;question=a+' √∑ '+b}else{a=randInt(10,50);b=randInt(2,9);var c=randInt(1,20);answer=a*b+c;question=a+' √ó '+b+' + '+c}}
      else{if(diff<=2){a=randInt(10,99);b=randInt(2,12);answer=a*b;question=a+' √ó '+b}else if(diff===3){b=randInt(5,25);answer=randInt(3,15);a=b*answer;question=a+' √∑ '+b}else if(diff===4){a=randInt(1,9);b=[2,4,5,10][randInt(0,3)];answer=a/b;question=a+' √∑ '+b}else{a=randInt(2,12);var exp=randInt(2,3);answer=Math.pow(a,exp);question=a+(exp===2?'¬≤':'¬≥')}}
      return{question:question,answer:String(answer)}
    }

    // ===================== WORD PICKER (NO REPEATS) =====================
    function pickNoRepeat(pool, usedMap, key){
      if(!usedMap[key])usedMap[key]={};
      var available=pool.filter(function(w){return !usedMap[key][w]});
      if(available.length===0){usedMap[key]={};available=pool.slice()}
      var item=pickRandom(available);usedMap[key][item]=true;return item;
    }

    function scrambleWord(word){
      var arr=word.split('');for(var i=arr.length-1;i>0;i--){var j=randInt(0,i);var t=arr[i];arr[i]=arr[j];arr[j]=t}
      var result=arr.join('');
      if(result===word&&word.length>2)return scrambleWord(word);
      return result;
    }

    // ===================== SCREENS =====================
    function showScreen(name){document.querySelectorAll('.screen').forEach(function(s){s.classList.remove('active')});document.getElementById('screen-'+name).classList.add('active')}
    function submitName(){var input=document.getElementById('name-input');var name=input.value.trim();if(!name){input.focus();return}state.playerName=name;document.getElementById('home-greeting').textContent='Hey '+name+'! Pick a subject!';showScreen('home')}
    document.getElementById('name-input').addEventListener('keydown',function(e){if(e.key==='Enter')submitName()});

    function selectSubject(subj){
      state.subject=subj;
      if(subj==='spelling'){showScreen('voice');return}
      var icons={math:'üî¢',scramble:'üîÄ',geography:'üåç'};
      var labels={math:'Math',scramble:'Scramble',geography:'Geography'};
      document.getElementById('grade-title').textContent=(icons[subj]||'')+' '+labels[subj];
      showScreen('grade');
    }
    function goBackFromGrade(){showScreen(state.subject==='spelling'?'voice':'home')}

    // ===================== VOICE =====================
    function findVoice(type){
      var voices=window.speechSynthesis.getVoices();if(!voices.length)return null;
      var isUS=type.indexOf('us')===0;var langPfx=isUS?'en-US':'en-GB';
      var names={'us-woman':['samantha','karen','allison','ava','zira','female'],'us-man':['alex','tom','fred','david','mark','male'],'uk-woman':['kate','serena','fiona','moira','hazel','female'],'uk-man':['daniel','oliver','arthur','george','male']};
      var prefs=names[type]||[];
      for(var i=0;i<prefs.length;i++){for(var j=0;j<voices.length;j++){if(voices[j].name.toLowerCase().indexOf(prefs[i])!==-1&&voices[j].lang.replace('_','-').indexOf(langPfx)===0)return voices[j]}}
      for(var j=0;j<voices.length;j++){if(voices[j].lang.replace('_','-').indexOf(langPfx)===0)return voices[j]}
      for(var j=0;j<voices.length;j++){if(voices[j].lang.indexOf('en')===0)return voices[j]}
      return null;
    }
    function selectVoice(type,btn){
      state.voiceChoice=type;
      document.querySelectorAll('.voice-card').forEach(function(c){c.classList.remove('selected')});
      if(btn)btn.classList.add('selected');
      if('speechSynthesis' in window){window.speechSynthesis.cancel();var v=findVoice(type);var u=new SpeechSynthesisUtterance('Hi '+(state.playerName||'there')+'! Ready to spell?');u.rate=0.72;u.pitch=1.0;u.volume=1.0;if(v)u.voice=v;window.speechSynthesis.speak(u)}
      document.getElementById('btn-confirm-voice').style.display='inline-block';
    }
    function confirmVoice(){document.getElementById('grade-title').textContent='üìñ Spelling';showScreen('grade')}
    if('speechSynthesis' in window){speechSynthesis.onvoiceschanged=function(){speechSynthesis.getVoices()};speechSynthesis.getVoices()}

    // ===================== GAME START =====================
    function startGame(grade){
      state.grade=grade;state.difficulty=1;state.streak=0;state.totalCorrect=0;state.totalAttempted=0;
      state.consecutiveCorrect=0;state.consecutiveWrong=0;state.usedWords={};state.usedGeo={};
      generateProblem();showScreen('play');updateUI();
      setTimeout(function(){var inp=document.getElementById('answer-input');if(inp)inp.focus()},300);
    }

    // ===================== PROBLEM GENERATION =====================
    function generateProblem(){
      var subj=state.subject,gr=state.grade,diff=state.difficulty;
      state.geoLocked=false;
      if(subj==='math'){
        state.problem=generateMathProblem(gr,diff);
      } else if(subj==='spelling'||subj==='scramble'){
        var words=(SPELLING_WORDS[gr]&&SPELLING_WORDS[gr][diff])||SPELLING_WORDS[gr][1];
        var word=pickNoRepeat(words,state.usedWords,gr+'-'+diff);
        state.problem={question:word,answer:word};
        if(subj==='scramble')state.problem.scrambled=scrambleWord(word);
      } else if(subj==='geography'){
        var qs=(GEO_QUESTIONS[gr]&&GEO_QUESTIONS[gr][diff])||GEO_QUESTIONS[gr][1];
        var qIdx=pickNoRepeat(qs.map(function(_,i){return i}),state.usedGeo,gr+'-'+diff);
        var q=qs[qIdx];
        state.problem={question:q.q,options:q.opts,correctIndex:q.a,answer:q.opts[q.a]};
      }
      document.getElementById('answer-input').value='';
      document.getElementById('feedback').style.display='none';
      document.getElementById('hint-text').style.display='none';
      updateUI();
      if(subj==='spelling')setTimeout(function(){speakWord()},400);
      if(subj!=='geography')setTimeout(function(){document.getElementById('answer-input').focus()},100);
    }

    // ===================== SPEAK WORD + SENTENCE =====================
    function speakWord(){
      if(!state.problem||state.subject!=='spelling'||!('speechSynthesis' in window))return;
      window.speechSynthesis.cancel();
      var word=state.problem.question,voice=findVoice(state.voiceChoice);
      var u1=new SpeechSynthesisUtterance(word);u1.rate=0.62;u1.pitch=1.05;u1.volume=1.0;if(voice)u1.voice=voice;
      var u2=new SpeechSynthesisUtterance(word);u2.rate=0.72;u2.pitch=1.0;u2.volume=1.0;if(voice)u2.voice=voice;
      window.speechSynthesis.speak(u1);
      u1.onend=function(){setTimeout(function(){window.speechSynthesis.speak(u2)},600)};
    }
    function speakSentence(){
      if(!state.problem||state.subject!=='spelling'||!('speechSynthesis' in window))return;
      window.speechSynthesis.cancel();
      var word=state.problem.question;
      var sentence=SENTENCES[word]||('The word is '+word+'.');
      var voice=findVoice(state.voiceChoice);
      // Say word, then sentence, then word again
      var u1=new SpeechSynthesisUtterance(word);u1.rate=0.62;u1.pitch=1.05;u1.volume=1.0;if(voice)u1.voice=voice;
      var u2=new SpeechSynthesisUtterance(sentence);u2.rate=0.78;u2.pitch=1.0;u2.volume=1.0;if(voice)u2.voice=voice;
      var u3=new SpeechSynthesisUtterance(word);u3.rate=0.62;u3.pitch=1.05;u3.volume=1.0;if(voice)u3.voice=voice;
      window.speechSynthesis.speak(u1);
      u1.onend=function(){setTimeout(function(){window.speechSynthesis.speak(u2);u2.onend=function(){setTimeout(function(){window.speechSynthesis.speak(u3)},500)}},500)};
    }

    // ===================== GEO ANSWER =====================
    function geoAnswer(idx){
      if(state.geoLocked)return;
      state.geoLocked=true;
      var correct=idx===state.problem.correctIndex;
      var btns=document.querySelectorAll('.geo-opt');
      btns[idx].classList.add(correct?'correct-pick':'wrong-pick');
      if(!correct)btns[state.problem.correctIndex].classList.add('reveal-correct');
      processAnswer(correct);
    }

    // ===================== CHECK ANSWER =====================
    function checkAnswer(){
      var input=document.getElementById('answer-input');var val=input.value.trim();if(!val)return;
      var correct;
      if(state.subject==='math')correct=parseFloat(val)===parseFloat(state.problem.answer);
      else correct=val.toLowerCase()===state.problem.answer.toLowerCase();
      input.value='';
      processAnswer(correct);
    }

    function processAnswer(correct){
      state.totalAttempted++;
      if(correct){
        state.totalCorrect++;state.streak++;state.consecutiveWrong=0;state.consecutiveCorrect++;
        if(state.consecutiveCorrect>=CORRECT_TO_LEVEL_UP&&state.difficulty<5){
          state.difficulty++;state.consecutiveCorrect=0;
          showGoatLevelUp();showConfetti();showFeedback(true,pickRandom(CORRECT_MSGS));
          setTimeout(function(){generateProblem()},3400);
        }else{showFeedback(true,pickRandom(CORRECT_MSGS));setTimeout(function(){generateProblem()},900)}
      }else{
        state.streak=0;state.consecutiveCorrect=0;state.consecutiveWrong++;
        if(state.consecutiveWrong>=WRONG_TO_LEVEL_DOWN&&state.difficulty>1){
          state.difficulty--;state.consecutiveWrong=0;
          showFeedback(false,"Let's try an easier level. You've got this! üí™",state.problem.answer);
          setTimeout(function(){generateProblem()},2200);
        }else{
          if(state.subject==='spelling'){
            var word=state.problem.answer;var hc=Math.floor(word.length*0.4);
            var hint=word.substring(0,hc+1)+word.substring(hc+1).replace(/[a-z]/gi,' _');
            var hintEl=document.getElementById('hint-text');hintEl.innerHTML='Hint: <strong>'+hint+'</strong>';hintEl.style.display='block';
          }
          showFeedback(false,pickRandom(WRONG_MSGS),state.problem.answer);
          setTimeout(function(){generateProblem()},2200);
        }
      }
      updateUI();
    }

    // ===================== UI =====================
    function updateUI(){
      document.getElementById('stat-score').textContent=state.totalCorrect+'/'+state.totalAttempted;
      var sHTML=String(state.streak);if(state.streak>=2){var sz=Math.min(state.streak*4+16,48);sHTML+=' <span class="streak-flame" style="font-size:'+sz+'px">üî•</span>'}
      document.getElementById('stat-streak').innerHTML=sHTML;
      document.getElementById('stat-level').textContent=state.difficulty+'/5';
      var rem=CORRECT_TO_LEVEL_UP-state.consecutiveCorrect;
      document.getElementById('progress-label').textContent=state.difficulty<5?rem+' more correct to level up!':"Max level ‚Äî you're a champion!";
      var pct=(state.consecutiveCorrect/CORRECT_TO_LEVEL_UP)*100;
      document.getElementById('progress-fill').style.width=Math.min(pct,100)+'%';
      for(var i=0;i<CORRECT_TO_LEVEL_UP;i++){var dot=document.getElementById('dot-'+i);if(dot)dot.className='progress-dot'+(i<state.consecutiveCorrect?' filled':'')}

      // Show/hide areas
      var areas=['math-area','spelling-area','scramble-area','geo-area'];
      areas.forEach(function(id){document.getElementById(id).style.display='none'});
      var inputArea=document.getElementById('text-input-area');
      var inp=document.getElementById('answer-input');

      if(state.subject==='math'){
        document.getElementById('math-area').style.display='block';
        document.getElementById('problem-type').textContent='Solve this problem';
        document.getElementById('math-expression').textContent=(state.problem?state.problem.question:'')+' = ?';
        inp.type='number';inp.placeholder='Your answer...';inputArea.style.display='flex';
      }else if(state.subject==='spelling'){
        document.getElementById('spelling-area').style.display='flex';
        document.getElementById('problem-type').textContent='Spell the word you hear';
        inp.type='text';inp.placeholder='Type the word...';inputArea.style.display='flex';
      }else if(state.subject==='scramble'){
        document.getElementById('scramble-area').style.display='block';
        document.getElementById('problem-type').textContent='Unscramble this word';
        document.getElementById('scramble-display').textContent=state.problem?state.problem.scrambled.toUpperCase():'';
        inp.type='text';inp.placeholder='Type the word...';inputArea.style.display='flex';
      }else if(state.subject==='geography'){
        document.getElementById('geo-area').style.display='block';
        document.getElementById('problem-type').textContent='Geography challenge';
        document.getElementById('geo-question').textContent=state.problem?state.problem.question:'';
        inputArea.style.display='none';
        if(state.problem){
          var optsHTML='';
          state.problem.options.forEach(function(opt,i){
            optsHTML+='<button class="geo-opt" onclick="geoAnswer('+i+')">'+opt+'</button>';
          });
          document.getElementById('geo-options').innerHTML=optsHTML;
        }
      }

      var subjLabels={math:'Math',spelling:'Spelling',scramble:'Scramble',geography:'Geography'};
      document.getElementById('info-footer').textContent='Grade '+state.grade+' ¬∑ '+(subjLabels[state.subject]||'')+' ¬∑ Difficulty '+state.difficulty+'/5 ¬∑ '+state.consecutiveCorrect+' in a row';
    }

    function showFeedback(correct,message,correctAnswer){
      var el=document.getElementById('feedback');
      var html='<div class="feedback-banner '+(correct?'correct':'wrong')+'"><span class="feedback-text">'+message+'</span>';
      if(!correct&&correctAnswer)html+='<span class="correct-answer-text">The answer was: <strong>'+correctAnswer+'</strong></span>';
      html+='</div>';el.innerHTML=html;el.style.display='block';
    }

    function showGoatLevelUp(){
      var overlay=document.getElementById('level-up-overlay');var name=state.playerName||'You';
      var phrases=[name+", you're the GOAT! üêê","GOAT STATUS! "+name+" is UNSTOPPABLE!","Baaaaa! "+name+" is the GREATEST OF ALL TIME!",name+" = G.O.A.T. üêêüêêüêê","LEVEL UP! "+name+", you're literally the GOAT!"];
      document.getElementById('level-up-msg').innerHTML='<span class="level-up-goat" style="animation:goatBounce 0.6s ease 3">üêê</span>'+pickRandom(phrases);
      overlay.style.display='flex';
      setTimeout(function(){playGoatSound()},300);
      if('speechSynthesis' in window){setTimeout(function(){window.speechSynthesis.cancel();var u=new SpeechSynthesisUtterance(name+'! You are the goat! Level up!');u.rate=0.85;u.pitch=1.2;u.volume=1.0;var v=findVoice(state.voiceChoice||'us-woman');if(v)u.voice=v;window.speechSynthesis.speak(u)},900)}
      setTimeout(function(){overlay.style.display='none'},3400);
    }

    function showConfetti(){
      var c=document.getElementById('confetti-container');var colors=['#FF6B6B','#4ECDC4','#FFE66D','#A78BFA','#F97316','#06D6A0','#FF69B4','#00D4FF'];var h='';
      for(var i=0;i<40;i++){var cl=colors[i%colors.length];var l=Math.random()*100;var d=Math.random()*0.5;var s=randInt(6,14);var du=1.5+Math.random();var r=Math.random()>0.5?'50%':'2px';var ro=randInt(0,360);
      h+='<div class="confetti-piece" style="left:'+l+'%;width:'+s+'px;height:'+s+'px;background:'+cl+';border-radius:'+r+';animation:confettiFall '+du+'s ease-out '+d+'s forwards;transform:rotate('+ro+'deg)"></div>'}
      c.innerHTML=h;setTimeout(function(){c.innerHTML=''},3000);
    }

    document.getElementById('answer-input').addEventListener('keydown',function(e){if(e.key==='Enter')checkAnswer()});
    setTimeout(function(){document.getElementById('name-input').focus()},300);

    if('serviceWorker' in navigator){window.addEventListener('load',function(){navigator.serviceWorker.register('sw.js').catch(function(){})})}
</script>
</body>
</html>